<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/htmt;charset=utf-8">
		<script type="text/javascript" src="jquery-1.7.2.min.js"></script>
	</head>
	<body>
    	<div style="height:1000px;"></div>
    	<div id="box1" style="position:absolute;left:200px;top:100px;width:300px;height:300px;border:1px solid #ccc;background-color:#fcf"></div>
        <div id="box2" style="position:absolute;left:800px;top:100px;width:300px;height:300px;border:1px solid #ccc;background-color:#3cc;"></div>
	</body>
    <script>
		$(function(){
			$.canmove($("#box1"),$("#box1"));
			$.canmove($("#box2"),$("#box2"));
		});
		(function($){
			if($.canmove){
				return;
			}
			//title、wrapper对象的postion需要设置为absolute
			//(title:要拖动的jquery对象，wrapper：要移动的jquery对象)
			$.canmove=function(title,wrapper){
				var mpos=null,wpos=null,ismove=false;
				title.bind("mousedown",function(e){
					if(e.which!=1)return;
					ismove=true;
					title.css("cursor","move");
					mpos={left:e.pageX,top:e.pageY};
					wpos={left:parseInt(wrapper.css("left").replace("px","")),top:parseInt(wrapper.css("top").replace("px",""))};
				}).bind("mouseup mouseout",function(){
					title.css("cursor","default");
				}).bind("mouseenter",function(){
					if(ismove)title.css("cursor","move");
				});
				$(document).bind("mousemove",function(e){
					if(!ismove)return;
					var pos={left:(wpos.left+e.pageX-mpos.left),top:(wpos.top+e.pageY-mpos.top)};
					//弹出框不能超过窗口四周
					var w=$(document).width()-wrapper.outerWidth(true);
					if(pos.left<0){
						wrapper.css("left",0);
					}else if(pos.left>w){
						wrapper.css("left",$(document).width()-wrapper.outerWidth(true));
					}else{
						wrapper.css("left",pos.left);
					}
					var h=$(document).height()-wrapper.outerHeight(true);
					if(pos.top<0){
						wrapper.css("top",0);
					}else if(pos.top>h){
						wrapper.css("top",h);
					}else{
						wrapper.css("top",pos.top);
					}
				}).bind("mouseup",function(){
					ismove=false;
				});
			}
		})(jQuery);
	</script>
</html>